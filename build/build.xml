<?xml version="1.0" encoding="UTF-8"?>
<project name="PHPFrame" default="build" basedir="../">
    <target name="build" 
            depends="checkout, php-documentor, php-codesniffer, phpunit" />

    <target name="checkout">
        <exec executable="git" dir="${basedir}">
            <arg line="pull" />
        </exec>
    </target>
    
    <target name="php-codesniffer">
        <exec executable="phpcs"
              dir="${basedir}/source"
              output="${basedir}/build/logs/checkstyle.xml">
            <arg line="--report=checkstyle --standard=PEAR ." />
        </exec>
    </target>

    <target name="phpunit">
        <exec executable="phpunit" dir="${basedir}/src" failonerror="on">
            <arg line="--log-xml ${basedir}/build/logs/phpunit.xml
                       --log-pmd ${basedir}/build/logs/phpunit.pmd.xml 
                       --log-metrics ${basedir}/build/logs/phpunit.metrics.xml 
                       --coverage-xml ${basedir}/build/logs/phpunit.coverage.xml 
                       --coverage-html ${basedir}/build/coverage 
                       ." />
        </exec>
    </target>
    
    <target name="php-documentor">
        <exec executable="phpdoc" dir="${basedir}/src">
            <arg line="-ct type -ue on -t ${basedir}/build/api
                       -tb /usr/share/php/data/phpUnderControl/data/phpdoc
                       -o HTML:Phpuc:phpuc -d ." />
        </exec>
    </target>
</project>
