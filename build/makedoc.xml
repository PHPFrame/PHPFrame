<?xml version="1.0" encoding="UTF-8"?>
<project name="PHPFrame-1.0" basedir="../" default="build">

	<property name="build.dir" value="${project.basedir}/build"/>
	<property name="report.dir" value="${build.dir}/report"/>
	<property name="doc.dir" value="${build.dir}/doc"/>
	
	<!-- Prepare directories -->
	<target name="prepare">
		<mkdir dir="${doc.dir}"/>
	</target>
	
	<!-- Generate API documentation from Javadoc comments using phpdoc -->
	<target name="apidoc">
		<exec 
			command="phpdoc \
					-d ${project.basedir} \
					-t ${doc.dir}/api \
					-ric README,INSTALL,FAQ,LICENSE,CREDITS \
					-i tests/,build/ \
					-s on \
					-dn None \
					-o HTML:Smarty:PHPFrame \
					-ti 'PHPFrame API Documentation'" 
			dir="${project.basedir}" 
			output="${report.dir}/phpdoc.log" />
	</target>
	
	<!-- Generate FULL documentation. This includes @private elements -->
	<target name="fulldoc">
		<exec 
			command="phpdoc \
					-d ${project.basedir} \
					-t ${doc.dir}/full \
					-ric README,INSTALL,FAQ,LICENSE,CREDITS \
					-i tests/,build/ \
					-s on \
					-dn None \
					-o HTML:Smarty:PHPFrame \
					-ti 'PHPFrame API Documentation' \
					-pp on" 
			dir="${project.basedir}" 
			output="${report.dir}/phpdoc.log" />
	</target>
	
	<target name="sync">
		<exec 
			command="rsync -vru -e 'ssh -p 2222' --delete \
					 ${doc.dir}/ \
					 phpframe@e-noise.com:~/public_html/doc/" 
			dir="${project.basedir}" 
			output="${report.dir}/rsync_doc.log" />
	</target>
	
	<target name="build" depends="prepare, apidoc, fulldoc, sync" />
	
</project>
